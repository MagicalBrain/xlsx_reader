CMAKE_MINIMUM_REQUIRED(VERSION 3.1)

PROJECT(XLSX_READER)
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_CXX_EXTENSIONS OFF)
if(MSVC)
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} /std:c++17")
endif(MSVC)

FIND_PACKAGE(MINIZ REQUIRED)
INCLUDE_DIRECTORIES(${MINIZ_INCLUDE_DIRS})

FIND_PACKAGE(TINYXML2 REQUIRED)
INCLUDE_DIRECTORIES(${TINYXML2_INCLUDE_DIRS})

find_package(nlohmann_json 3.2.0 REQUIRED)
INCLUDE_DIRECTORIES(${nlohmann_json_include_dirs})

SET(XLSX_READER_SRC_DIR ${CMAKE_SOURCE_DIR}/source)
SET(XLSX_READER_THIRD_PARTY_DIR ${CMAKE_SOURCE_DIR}/third_party)
SET(XLSX_READER_HEADER_DIR ${CMAKE_SOURCE_DIR}/include)
SET(XLSX_READER_TEST_DIR ${CMAKE_SOURCE_DIR}/test)

FILE(GLOB_RECURSE XLSX_READER_SRC_LIST ${XLSX_READER_SRC_DIR}/*.cpp)
FILE(GLOB_RECURSE XLSX_READER_TEST_LIST ${XLSX_READER_TEST_DIR}/*.cpp)

INCLUDE_DIRECTORIES(${XLSX_READER_HEADER_DIR})

# https://cmake.org/cmake/help/latest/prop_tgt/CXX_STANDARD.html

# expected behaviour
#set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} /std:c++lastest")
ADD_EXECUTABLE("xlsx_test" ${XLSX_READER_TEST_LIST} ${XLSX_READER_SRC_LIST} )
target_link_libraries("xlsx_test" ${MINIZ_LIRRARIES} ${TINYXML_LIBRARIES} PRIVATE nlohmann_json::nlohmann_json)
